{% extends template %}
{% block content %}


  {% if posts|length %}
  {% for post in posts %}

  <div class="infinite-item card ms-3 my-3 " style="width: 95%;">
    <img src="{{ post.image }}" class="card-img-top">
    <div class="card-body">
      <a href="{% url 'detail' post.fundraiser.id %}" class="text-decoration-none">
        <p>{{ post.fundraiser.name }}</p>
      </a>
      <hr>
      <div class="d-flex justify-content-between">
        <h4 class="card-title py-4">{{ post.title }}</h4>
        <p class="card-title py-4 mt-1">{{ post.owner }}</p>
      </div>
      <div class="d-flex py-2">
        <p class="flex-grow-1 text-start fw-semibold">Posted:</p>
        <p>{{ post.date_created }}</p>
      </div>
      <p class="card-text text-start">{{ post.content }}</p>
    </div>
    {% if user.id == post.fundraiser.owner_id %}
    <div class="p-4 inline">
      <a href="{% url 'delete_post' post_id=post.id fundr_id=post.fundraiser.id %}"
        class="btn btn-danger float-end ">Delete</a>
    </div>
    {% endif %}
  </div>
  {% endfor %}

  {% if posts.has_next %}
  <a class="infinite-more-link" href="?page={{ posts.next_page_number }}">More</a>
  {% endif %}
  <div class="loading" style="display: none;">
    Loading...
  </div>

  {% else %}

  <h2>No posts to show, <br>go <a href="{% url 'explore' %}">explore</a> some fundrs!</h2>

  {% endif %}


<script>
  var infinite = new Waypoint.Infinite({
    element: $('.infinite-container')[0],
    offset: 'bottom-in-view',
    onBeforePageLoad: function () {
      $('.loading').show();
    },

    onAfterPageLoad: function ($items) {
      $('.loading').hide();
    }
  });


  // var waypoint = new Waypoint({
  // element: document.querySelector('.infinite-container'),
  // handler: function(direction) {
  //   notify('Handler triggered in ' + direction + ' direction')
  // },
  // offset: 'bottom-in-view'
// })
</script>
{% endblock %}